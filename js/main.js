$(function(){$(".sidebar-toc__content").children().length>0?$(".layout_post").animate({},function(){setTimeout(function(){$("#page-header").addClass("open-sidebar"),$("#toggle-sidebar").addClass("on"),$("body").animate({paddingLeft:300},200),$("#sidebar").animate({},function(){$("#sidebar").css({transform:"translateX(300px)"})}),$("#toggle-sidebar").animate({},function(){$("#toggle-sidebar").css({transform:"rotateZ(180deg)",color:"#99a9bf",opacity:"1"})})},200)}):$("#toggle-sidebar").css("display","none"),$("#toggle-sidebar").on("click",function(){if(!isMobile()&&$("#sidebar").is(":visible")){var t=$(this).hasClass("on");t?$(this).removeClass("on"):$(this).addClass("on"),t?($("#page-header").removeClass("open-sidebar"),$("body").animate({paddingLeft:0},200),$("#sidebar").animate({},function(){$("#sidebar").css({transform:"translateX(0px)"})}),$("#toggle-sidebar").animate({},function(){$("#toggle-sidebar").css({transform:"rotateZ(0deg)",color:"#1F2D3D"})})):($("#page-header").addClass("open-sidebar"),$("body").animate({paddingLeft:300},200),$("#sidebar").animate({},function(){$("#sidebar").css({transform:"translateX(300px)"})}),$("#toggle-sidebar").animate({},function(){$("#toggle-sidebar").css({transform:"rotateZ(180deg)",color:"#99a9bf"})}))}}),/Android|webOS|iPhone|iPod|iPad|BlackBerry/i.test(navigator.userAgent)||$(".full_page").css("background-attachment","fixed"),$("#to_comment").on("click",function(){scrollTo("#post-comment")}),$(".scroll-down").on("click",function(){scrollTo("#content-outer")});var t=document.querySelectorAll(".tag-cloud .tag-cloud-tags a");$(window).width()>768?Array.prototype.forEach.call(t,(t,a)=>{t.style.fontSize=Math.floor(20*Math.random()+15)+"px",t.style.color="rgb("+Math.floor(201*Math.random())+", "+Math.floor(201*Math.random())+", "+Math.floor(201*Math.random())+")"}):Array.prototype.forEach.call(t,(t,a)=>{t.style.fontSize=Math.floor(13*Math.random()+15)+"px",t.style.color="rgb("+Math.floor(201*Math.random())+", "+Math.floor(201*Math.random())+", "+Math.floor(201*Math.random())+")"}),$.fancyConfirm=function(t){t=$.extend(!0,{title:"Are you sure?",message:"",okButton:"OK",noButton:"Cancel",callback:$.noop},t||{}),$.fancybox.open({type:"html",src:'<div class="fc-content"><h3>'+t.title+"</h3><p>"+t.message+'</p><p class="tright"><button data-value="1" data-fancybox-close class="bookmark-ok">'+t.okButton+"</button></p></div>",opts:{animationDuration:350,animationEffect:"material",modal:!0,baseTpl:'<div class="fancybox-container fc-container" role="dialog" tabindex="-1"><div class="fancybox-bg"></div><div class="fancybox-inner"><div class="fancybox-stage"></div></div></div>'}})},$("#bookmark-it").click(function(){if(window.sidebar&&window.sidebar.addPanel)window.sidebar.addPanel(document.title,window.location.href,"");else if(window.external&&"AddFavorite"in window.external)window.external.AddFavorite(location.href,document.title);else{if(window.opera&&window.print)return this.title=document.title,!0;$.fancyConfirm({title:"添加書籤？",message:"按 "+(-1!=navigator.userAgent.toLowerCase().indexOf("mac")?"Command/Cmd":"CTRL")+" + D 鍵將本頁加入書籤.",okButton:"OK"})}});var a=$(".recent-post-info  img");0===a.length&&(a=$("#post-content img"));for(var e=0;e<a.length;e++){var o=$('<a href="'+a[e].src+'" data-fancybox="group" data-caption="'+a[e].alt+'" class="fancybox"></a>'),i=a[e].alt,n=$(a[e]).wrap(o);i&&n.after('<div class="img-alt">'+i+"</div>")}$().fancybox({selector:"[data-fancybox]",loop:!0,transitionEffect:"slide",protect:!0,buttons:["slideShow","fullScreen","thumbs","close"]});var s=$(".gallery-item"),r=[];s.each(function(t,a){r.push({src:$(a).data("url"),opts:{caption:$(a).data("title")}})}),s.on("click",function(){return $.fancybox.open(r,{loop:!0,transitionEffect:"slide"},s.index(this)),!1});var l=$("#post img");l.addClass("lozad"),l.each(function(){var t=$(this).attr("src");$(this).attr("data-src",t),$(this).removeAttr("src")}),lozad().observe(),$(".toggle-menu").on("click",function(){$(".toggle-menu").toggleClass("close"),$("#page-header .menus").toggleClass("munus_tran"),$("#page-header .pull-left #site-name,#page-header .search,#page-header  .toggle-menu *").toggleClass("is-back"),$("#page-header .toggle-menu *").toggleClass("is-back-background"),$("body,html").toggleClass("is-hidden")});var c=0;function d(t){scrollTo(t)}$(".toc-child").hide(),$(window).scroll(throttle(function(t){var a=$(this).scrollTop();isMobile()||(function(t){var a=$("#content-outer").height(),e=$(window).height(),o=a>e?a-e:$(document).height()-e,i=t/o,n=Math.round(100*i),s=n>100?100:n;$(".progress-num").text(s),$(".sidebar-toc__progress-bar").animate({width:s+"%"},100)}(a),function(t){if(0===$(".toc-link").length)return!1;var a=$("#post-content").find("h1,h2,h3,h4,h5,h6"),e="";a.each(function(){var a=$(this);t>a.offset().top-25&&(e="#"+$(this).attr("id"))}),""===e&&($(".toc-link").removeClass("active"),$(".toc-child").hide());var o=$(".toc-link.active");if(e&&o.attr("href")!==e){r=e,window.history.replaceState&&r!==window.location.hash&&window.history.replaceState(void 0,void 0,r),$(".toc-link").removeClass("active");var i=$('.toc-link[href="'+e+'"]');i.addClass("active");var n=i.parents(".toc-child"),s=n.length>0?n.last():i;!function(t){if(t.is(":visible"))return;t.fadeIn(400)}(s.closest(".toc-item").find(".toc-child")),s.closest(".toc-item").siblings(".toc-item").find(".toc-child").hide()}var r}(a));var e=function(t){var a=t>c;return c=t,a}(a);a>56?(e?$("#page-header").hasClass("visible")?$("#page-header").removeClass("visible"):console.log():$("#page-header").hasClass("visible")?console.log():$("#page-header").addClass("visible"),$("#page-header").addClass("fixed"),"0"===$("#go-up").css("opacity")&&$("#go-up").animate({},function(){$("#go-up").css({opacity:"1",transform:"translateX(-30px) rotateZ(360deg)"})}),"0"===$("#rightside").css("opacity")&&$("#rightside").animate({},function(){$("#rightside").css({opacity:"1",transform:"translateX(-38px)"})})):(0===a&&$("#page-header").removeClass("fixed").removeClass("visible"),$("#go-up").animate({},function(){$("#go-up").css({opacity:"0",transform:"translateX(0) rotateZ(180deg) "})}),$("#rightside").animate({},function(){$("#rightside").css({opacity:"0",transform:"translateX(0)"})}))},50,100)),$("#go-up").on("click",function(){scrollTo("body")}),$("#post-content").find("h1,h2,h3,h4,h5,h6").on("click",function(t){d("#"+$(this).attr("id"))}),$(".toc-link").on("click",function(t){t.preventDefault(),d($(this).attr("href"))}),$("figure").on("dblclick",function(t){t.target===this&&($(this).toggleClass("code_full_page"),$("body").toggleClass("code_body"))})});